{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43800208-301c21487611dae4b6f535cf2';\n\nexport const fetchImagesByQuery = async (queryString = 'pug', page = 1) => {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: queryString,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page,\n  });\n  const response = await axios.get(`${BASE_URL}?${searchParams}`);\n  try {\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.statusText);\n  }\n};\n","export const createGalleryItemMarkup = images => {\n  return images\n    .map(\n      image => `\n<li class='gallery-item'>\n<a class='gallery-item-link' href='${image.largeImageURL}'>\n    <img\n    src='${image.webformatURL}'\n    alt='${image.tags}'>\n</a>\n<div class='stats'>\n<span>\n<p class='stat-name'>Likes</p>\n<p class='stat-value'>${image.likes}</p>\n</span>\n<span>\n<p class='stat-name'>Views</p>\n<p class='stat-value'>${image.views}</p>\n</span>\n<span>\n<p class='stat-name'>Comments</p>\n<p class='stat-value'>${image.comments}</p>\n</span>\n<span>\n<p class='stat-name'>Downloads</p>\n<p class='stat-value'>${image.downloads}</p>\n</span>\n</div>\n</li>\n`\n    )\n    .join('');\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImagesByQuery } from './js/pixabay-api.js';\nimport { createGalleryItemMarkup } from './js/render-functions.js';\n\nconst galleryEl = document.querySelector('.gallery');\nconst searchFormEl = document.querySelector('.search-form');\nconst loaderEl = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nlet searchQuery = '';\nlet currentPage = 1;\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  searchQuery = event.target.elements.searchQuery.value.trim();\n  if (searchQuery === '') {\n    galleryEl.innerHTML = '';\n    event.target.reset();\n    iziToast.warning({\n      position: 'topRight',\n      transitionIn: 'bounceInLeft',\n      message: 'input field cannot be empty',\n      messageSize: 16,\n      timeout: 3000,\n    });\n    return;\n  }\n\n  galleryEl.innerHTML = '';\n  currentPage = 1;\n  loadMoreBtnEl.classList.add('is-hidden');\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const imagesData = await fetchImagesByQuery(searchQuery, currentPage);\n    if (imagesData.total === 0) {\n      event.target.reset();\n      iziToast.error({\n        position: 'topRight',\n        transitionIn: 'bounceInLeft',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageSize: 16,\n        timeout: 3000,\n      });\n    } else {\n      galleryEl.innerHTML = createGalleryItemMarkup(imagesData.hits);\n      const lightbox = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n      });\n      lightbox.refresh();\n      if (imagesData.totalHits > currentPage * 15) {\n        loadMoreBtnEl.classList.remove('is-hidden');\n      }\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    event.target.reset();\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nasync function onLoadMoreBtnClick() {\n  currentPage += 1;\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const initialHeight =\n      galleryEl.firstElementChild.getBoundingClientRect().height;\n    const imagesData = await fetchImagesByQuery(searchQuery, currentPage);\n    galleryEl.insertAdjacentHTML(\n      'beforeend',\n      createGalleryItemMarkup(imagesData.hits)\n    );\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    window.scrollBy({\n      top: initialHeight * 2,\n      behavior: 'smooth',\n    });\n    if (imagesData.totalHits <= currentPage * 15) {\n      loadMoreBtnEl.classList.add('is-hidden');\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loaderEl.classList.add('is-hidden');\n  }\n}\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n"],"names":["BASE_URL","API_KEY","fetchImagesByQuery","queryString","page","searchParams","response","axios","error","createGalleryItemMarkup","images","image","galleryEl","searchFormEl","loaderEl","loadMoreBtnEl","searchQuery","currentPage","onSearchFormSubmit","event","iziToast","imagesData","SimpleLightbox","onLoadMoreBtnClick","initialHeight"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAEHC,EAAqB,MAAOC,EAAc,MAAOC,EAAO,IAAM,CACzE,MAAMC,EAAe,IAAI,gBAAgB,CACvC,IAAKJ,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMC,CACV,CAAG,EACKE,EAAW,MAAMC,EAAM,IAAI,GAAGP,CAAQ,IAAIK,CAAY,EAAE,EAC9D,GAAI,CACF,OAAOC,EAAS,IACjB,OAAQE,EAAO,CACd,MAAM,IAAI,MAAMA,EAAM,SAAS,UAAU,CAC1C,CACH,ECrBaC,EAA0BC,GAC9BA,EACJ,IACCC,GAAS;AAAA;AAAA,qCAEsBA,EAAM,aAAa;AAAA;AAAA,WAE7CA,EAAM,YAAY;AAAA,WAClBA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,wBAKGA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,wBAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,wBAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,wBAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,CAKlC,EACA,KAAK,EAAE,ECtBNC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAe,SAAS,cAAc,cAAc,EACpDC,EAAW,SAAS,cAAc,SAAS,EAC3CC,EAAgB,SAAS,cAAc,gBAAgB,EAE7D,IAAIC,EAAc,GACdC,EAAc,EAElB,eAAeC,EAAmBC,EAAO,CAGvC,GAFAA,EAAM,eAAc,EACpBH,EAAcG,EAAM,OAAO,SAAS,YAAY,MAAM,OAClDH,IAAgB,GAAI,CACtBJ,EAAU,UAAY,GACtBO,EAAM,OAAO,QACbC,EAAS,QAAQ,CACf,SAAU,WACV,aAAc,eACd,QAAS,8BACT,YAAa,GACb,QAAS,GACf,CAAK,EACD,MACD,CAEDR,EAAU,UAAY,GACtBK,EAAc,EACdF,EAAc,UAAU,IAAI,WAAW,EACvCD,EAAS,UAAU,OAAO,WAAW,EAErC,GAAI,CACF,MAAMO,EAAa,MAAMnB,EAAmBc,EAAaC,CAAW,EAChEI,EAAW,QAAU,GACvBF,EAAM,OAAO,QACbC,EAAS,MAAM,CACb,SAAU,WACV,aAAc,eACd,QACE,2EACF,YAAa,GACb,QAAS,GACjB,CAAO,IAEDR,EAAU,UAAYH,EAAwBY,EAAW,IAAI,EAC5C,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GACtB,CAAO,EACQ,QAAO,EACZD,EAAW,UAAYJ,EAAc,IACvCF,EAAc,UAAU,OAAO,WAAW,EAG/C,OAAQP,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRW,EAAM,OAAO,QACbL,EAAS,UAAU,IAAI,WAAW,CACnC,CACH,CAEA,eAAeS,GAAqB,CAClCN,GAAe,EACfH,EAAS,UAAU,OAAO,WAAW,EAErC,GAAI,CACF,MAAMU,EACJZ,EAAU,kBAAkB,sBAAuB,EAAC,OAChDS,EAAa,MAAMnB,EAAmBc,EAAaC,CAAW,EACpEL,EAAU,mBACR,YACAH,EAAwBY,EAAW,IAAI,CAC7C,EACqB,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GACpB,CAAK,EACQ,QAAO,EAEhB,OAAO,SAAS,CACd,IAAKE,EAAgB,EACrB,SAAU,QAChB,CAAK,EACGH,EAAW,WAAaJ,EAAc,IACxCF,EAAc,UAAU,IAAI,WAAW,CAE1C,OAAQP,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRM,EAAS,UAAU,IAAI,WAAW,CACnC,CACH,CAEAD,EAAa,iBAAiB,SAAUK,CAAkB,EAC1DH,EAAc,iBAAiB,QAASQ,CAAkB"}